/*
 * Swipe 2.0
 *
 * Brad Birdsall
 * Copyright 2013, MIT License
 * - - - MODIFIED TO ALLOW CLICK AND DRAG - - -
 *
*/function Swipe(e,t){"use strict";function v(){f=a.children;h=f.length;f.length<2&&(t.continuous=!1);if(i.transitions&&t.continuous&&f.length<3){a.appendChild(f[0].cloneNode(!0));a.appendChild(a.children[1].cloneNode(!0));f=a.children}l=new Array(f.length);c=e.getBoundingClientRect().width||e.offsetWidth;a.style.width=f.length*c+"px";var n=f.length;while(n--){var r=f[n];r.style.width=c+"px";r.setAttribute("data-index",n);if(i.transitions){r.style.left=n*-c+"px";w(n,p>n?-c:p<n?c:0,0)}}if(t.continuous&&i.transitions){w(y(p-1),-c,0);w(y(p+1),c,0)}i.transitions||(a.style.left=p*-c+"px");e.style.visibility="visible"}function m(){t.continuous?b(p-1):p&&b(p-1)}function g(){t.continuous?b(p+1):p<f.length-1&&b(p+1)}function y(e){return(f.length+e%f.length)%f.length}function b(e,n){if(p==e)return;if(i.transitions){var s=Math.abs(p-e)/(p-e);if(t.continuous){var o=s;s=-l[y(e)]/c;s!==o&&(e=-s*f.length+e)}var u=Math.abs(p-e)-1;while(u--)w(y((e>p?e:p)-u-1),c*s,0);e=y(e);w(p,c*s,n||d);w(e,0,n||d);t.continuous&&w(y(e-s),-(c*s),0)}else{e=y(e);S(p*-c,e*-c,n||d)}p=e;r(t.callback&&t.callback(p,f[p]))}function w(e,t,n){E(e,t,n);l[e]=t}function E(e,t,n){var r=f[e],i=r&&r.style;if(!i)return;i.webkitTransitionDuration=i.MozTransitionDuration=i.msTransitionDuration=i.OTransitionDuration=i.transitionDuration=n+"ms";i.webkitTransform="translate("+t+"px,0)"+"translateZ(0)";i.msTransform=i.MozTransform=i.OTransform="translateX("+t+"px)"}function S(e,n,r){if(!r){a.style.left=n+"px";return}var i=+(new Date),s=setInterval(function(){var o=+(new Date)-i;if(o>r){a.style.left=n+"px";x&&N();t.transitionEnd&&t.transitionEnd.call(event,p,f[p]);clearInterval(s);return}a.style.left=(n-e)*(Math.floor(o/r*100)/100)+e+"px"},4)}function N(){T=setTimeout(g,x)}function C(){x=0;clearTimeout(T)}var n=function(){},r=function(e){setTimeout(e||n,0)},i={addEventListener:!!window.addEventListener,touch:"ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch,mstouch:window.navigator&&window.navigator.msPointerEnabled,pointer:window.navigator&&window.navigator.pointerEnabled,transitions:function(e){var t=["transitionProperty","WebkitTransition","MozTransition","OTransition","msTransition"];for(var n in t)if(e.style[t[n]]!==undefined)return!0;return!1}(document.createElement("swipe"))},s="mousedown",o="mousemove",u="mouseup";if(i.touch){s="touchstart";o="touchmove";u="touchend"}else if(i.pointer){s="pointerdown";o="pointermove";u="pointerup"}else if(i.mstouch){s="MSPointerDown";o="MSPointerMove";u="MSPointerUp"}if(!e)return;var a=e.children[0],f,l,c,h;t=t||{};var p=parseInt(t.startSlide,10)||0,d=t.speed||300;t.continuous=t.continuous!==undefined?t.continuous:!0;var x=t.auto||0,T,k={},L={},A,O={handleEvent:function(e){switch(e.type){case s:this.start(e);break;case o:this.move(e);break;case u:r(this.end(e));break;case"click":e.preventDefault();e.stopImmediatePropagation();break;case"webkitTransitionEnd":case"msTransitionEnd":case"oTransitionEnd":case"otransitionend":case"transitionend":r(this.transitionEnd(e));break;case"resize":r(v.call())}t.stopPropagation&&e.stopPropagation()},start:function(e){var t=i.touch?e.touches[0]:e;i.touch||e.preventDefault();k={x:t.pageX,y:t.pageY,time:+(new Date)};A=undefined;L={};a.addEventListener(o,this,!1);a.addEventListener(u,this,!1)},move:function(e){if(e.touches&&e.touches.length>1||e.scale&&e.scale!==1)return;t.disableScroll&&e.preventDefault();var n=i.touch?e.touches[0]:e;L={x:n.pageX-k.x,y:n.pageY-k.y};typeof A=="undefined"&&(A=!!(A||Math.abs(L.x)<Math.abs(L.y)));if(!A){e.preventDefault();C();if(t.continuous){E(y(p-1),L.x+l[y(p-1)],0);E(p,L.x+l[p],0);E(y(p+1),L.x+l[y(p+1)],0)}else{L.x=L.x/(!p&&L.x>0||p==f.length-1&&L.x<0?Math.abs(L.x)/c+1:1);E(p-1,L.x+l[p-1],0);E(p,L.x+l[p],0);E(p+1,L.x+l[p+1],0)}}},end:function(e){var n=+(new Date)-k.time,r=Number(n)<250&&Math.abs(L.x)>20||Math.abs(L.x)>c/2,i=!p&&L.x>0||p==f.length-1&&L.x<0;t.continuous&&(i=!1);var s=L.x<0;if(!A)if(r&&!i){if(s){if(t.continuous){w(y(p-1),-c,0);w(y(p+2),c,0)}else w(p-1,-c,0);w(p,l[p]-c,d);w(y(p+1),l[y(p+1)]-c,d);p=y(p+1)}else{if(t.continuous){w(y(p+1),c,0);w(y(p-2),-c,0)}else w(p+1,c,0);w(p,l[p]+c,d);w(y(p-1),l[y(p-1)]+c,d);p=y(p-1)}t.callback&&t.callback(p,f[p])}else if(t.continuous){w(y(p-1),-c,d);w(p,0,d);w(y(p+1),c,d)}else{w(p-1,-c,d);w(p,0,d);w(p+1,c,d)}a.removeEventListener(o,O,!1);a.removeEventListener(u,O,!1)},transitionEnd:function(e){if(parseInt(e.target.getAttribute("data-index"),10)==p){x&&N();t.transitionEnd&&t.transitionEnd.call(e,p,f[p])}}};v();x&&N();if(i.addEventListener){a.addEventListener(s,O,!1);t.preventClick&&a.addEventListener("click",O,!1);if(i.transitions){a.addEventListener("webkitTransitionEnd",O,!1);a.addEventListener("msTransitionEnd",O,!1);a.addEventListener("oTransitionEnd",O,!1);a.addEventListener("otransitionend",O,!1);a.addEventListener("transitionend",O,!1)}window.addEventListener("resize",O,!1)}else window.onresize=function(){v()};return{setup:function(){v()},slide:function(e,t){C();b(e,t)},prev:function(){C();m()},next:function(){C();g()},getPos:function(){return p},getNumSlides:function(){return h},kill:function(){C();a.style.width="auto";a.style.left=0;var e=f.length;while(e--){var n=f[e];n.style.width="100%";n.style.left=0;i.transitions&&E(e,0,0)}if(i.addEventListener){a.removeEventListener(s,O,!1);t.preventClick&&a.removeEventListener("click",O,!1);a.removeEventListener("webkitTransitionEnd",O,!1);a.removeEventListener("msTransitionEnd",O,!1);a.removeEventListener("oTransitionEnd",O,!1);a.removeEventListener("otransitionend",O,!1);a.removeEventListener("transitionend",O,!1);window.removeEventListener("resize",O,!1)}else window.onresize=null}}}(window.jQuery||window.Zepto)&&function(e){e.fn.Swipe=function(t){return this.each(function(){e(this).data("Swipe",new Swipe(e(this)[0],t))})}}(window.jQuery||window.Zepto);