var LaMadLocations={sideMap:null,currentLocationObj:{latitude:null,longitude:null},nearestLocationObj:{latitude:null,longitude:null},$locationCta:$("#location-cta"),$directionsLink:"",$toGoLink:"https://order.lamadeleine.com/index.cfm?fuseaction=order&action=preorder&isToGo=1",clickEvent:"",setClickEvent:function(o){$("html").hasClass("touch")?this.clickEvent="touchend":this.clickEvent="click"},$frontWrapper:function(){return this.$locationCta.find(".front-wrapper")},mapStyles:[{featureType:"landscape.natural",elementType:"geometry.fill",stylers:[{color:"#e0d5ab"}]},{featureType:"poi",elementType:"geometry.fill",stylers:[{color:"#ddc692"}]},{featureType:"water",elementType:"geometry.fill",stylers:[{color:"#9fc8b1"}]},{featureType:"road",elementType:"geometry.fill",stylers:[{visibility:"on"},{color:"#fff6da"}]},{featureType:"landscape.man_made",elementType:"geometry.fill",stylers:[{color:"#e4dbb9"}]},{featureType:"road.highway.controlled_access",elementType:"geometry.fill",stylers:[{color:"#ffa93d"}]},{featureType:"road.local",elementType:"geometry.fill",stylers:[{color:"#f1e6c6"}]},{featureType:"poi.government",elementType:"geometry.fill"}],initializeMap:function(o,e,a){var t=$("#"+a);if(t.length){newLat=parseFloat(o)+.007,newLng=parseFloat(e),myCenter=new google.maps.LatLng(newLat,newLng);var n=new google.maps.StyledMapType(LaMadLocations.mapStyles,{name:"La Madeleine"}),i=new google.maps.LatLng(o,e),s={panControl:!1,scrollwheel:!1,draggable:!1,zoomControl:!1,mapTypeControl:!1,scaleControl:!1,streetViewControl:!1,overviewMapControl:!1,center:myCenter,zoom:12,mapTypeControlOptions:{mapTypeIds:[google.maps.MapTypeId.ROADMAP,"map_style"]}},d=new google.maps.Map(document.getElementById(a),s);d.mapTypes.set("map_style",n),d.setMapTypeId("map_style"),"undefined"!=typeof icon?displayIcon="/wp-content/themes/required-lamadeleine/img/map/blue-dot.png":displayIcon={url:"/wp-content/themes/required-lamadeleine/img/map/custom-pin-drop.png",scaledSize:new google.maps.Size(48,52)};new google.maps.Marker({position:i,map:d,title:"La Madeleine Location",icon:displayIcon});this.sideMap=d,$("#directionsLinkButton").show()}},getTodayHours:function(o){var e=new Array(7);e[0]="sunday",e[1]="monday",e[2]="tuesday",e[3]="wednesday",e[4]="thursday",e[5]="friday",e[6]="saturday";var a=new Date;if(dayIndex=a.getDay(),dayOfWeek=e[dayIndex],ucaseDayofWeek=dayOfWeek.charAt(0).toUpperCase()+dayOfWeek.slice(1),t=!1,null!=o.days_closed&&o.days_closed.indexOf(ucaseDayofWeek)>=0)var t="Closed on "+ucaseDayofWeek;var n=dayOfWeek+"_open",i=dayOfWeek+"_close",s={closed_today:t,open:o[n],close:o[i]};return s},setLocation:function(o,e,a){var t="map",n=LaMadLocations.getTodayHours(o);if(o.address_2.length>0)var i=o.address+"<br>"+o.address_2;else var i=o.address;LaMadLocations.nearestLocationObj=o,loadingIndicator='<div class="loading"><div class="floatingCirclesG"><div class="f_circleG frotateG_01"></div><div class="f_circleG frotateG_02"></div><div class="f_circleG frotateG_03"></div><div class="f_circleG frotateG_04"></div><div class="f_circleG frotateG_05"></div><div class="f_circleG frotateG_06"></div><div class="f_circleG frotateG_07"></div><div class="f_circleG frotateG_08"></div></div></div>',0==n.closed_today?$("#location-info").html('<h4 class="location-title">'+o.title+'</h4><div class="info-wrapper"><div class="address"><strong>Address:</strong><br>'+i+"<br>"+o.city+", "+o.state+" "+o.zip_code+'</div><div class="phone"><strong>Phone:</strong><br>'+o.phone+'</div></div><div class="hours"><strong>Today\'s Hours:</strong> '+n.open+" - "+n.close+"</div>"):$("#location-info").html('<h4 class="location-title">'+o.title+'</h4><div class="info-wrapper"><div class="address"><strong>Address:</strong><br>'+i+"<br>"+o.city+", "+o.state+" "+o.zip_code+'</div><div class="phone"><strong>Phone:</strong><br>'+o.phone+'</div></div><div class="hours"><strong>Today\'s Hours:</strong> Closed</div>'),0==n.closed_today?$("#widget-location-mobile").html('<h4 class="location-title">'+o.title+'</h4><hr class="dashed"><div class="info-wrapper"><div class="address"><strong>Address:</strong><br>'+o.address+" "+o.address_2+"<br>"+o.city+", "+o.state+" "+o.zip_code+'</div><div class="hours"><div><strong>Today\'s Hours:</strong></div> '+n.open+" - "+n.close+'</div><div class="btn-wrapper"><a class="btn get-directions" href="#"><span>Directions</span>'+loadingIndicator+'</a><a class="btn daypart-menu" href="#">Menu</a><a class="btn call" href="tel:'+o.phone+'"><span class="icon icon-phone"></span> Call</a><div class="other-locations"><hr class="dashed"><h2>Other Nearby Locations</h2><div id="location-list-mobile"></div></div>'):$("#widget-location-mobile").html('<h4 class="location-title">'+o.title+'</h4><hr class="dashed"><div class="info-wrapper"><div class="address"><strong>Address:</strong><br>'+o.address+" "+o.address_2+"<br>"+o.city+", "+o.state+" "+o.zip_code+'</div><div class="hours"><div><strong>Today\'s Hours:</strong></div>Closed</div><div class="btn-wrapper"><a class="btn get-directions" href="#"><span>Directions</span>'+loadingIndicator+'</a><a class="btn daypart-menu" href="#">Menu</a><a class="btn call" href="tel:'+o.phone+'"><span class="icon icon-phone"></span> Call</a><div class="other-locations"><hr class="dashed"><h2>Other Nearby Locations</h2><div id="location-list-mobile"></div></div>'),("undefined"==typeof a||0==a)&&LaMadLocations.setLocationCookie(o),"undefined"!=typeof e&&LaMadLocations.initializeMap(o.latitude,o.longitude,t),$("body").removeClass("no-location"),$("body").addClass("has-location"),$("#content").find("a.get-directions").off(this.clickEvent).on(this.clickEvent,function(o){o.preventDefault(),LaMadLocations.getDirections(this)}),$("#content").find("a.order-online").off(this.clickEvent).on(this.clickEvent,function(o){o.preventDefault(),LaMadLocations.getToGoLink(this),o.stopPropagation()}),$("#content").find(".btn.locate").on(this.clickEvent,function(o){o.preventDefault(),LaMadLocations.refreshLocation(this)}),$("#content").find(".lam-call a").attr("href","tel:"+o.phone);var s=$.cookie("LAM-daypart");if("undefined"!=typeof s)var d=$.parseJSON(s),r=!0;r&&$("#content").find("a.daypart-menu").attr("href",d.link.guid)},setLocationCookie:function(o){this.nearestLocationObj=o,$.cookie("LAM-location",JSON.stringify(o),{expires:10,path:"/"})},setNearbyLocationsStorage:function(o){localStorage.setItem("LAM-nearby",JSON.stringify(o)),"undefined"!=typeof LaMadLocations.loadNearest&&LaMadLocations.loadNearest()},getLocationCookie:function(){cookieLoc=$.cookie("LAM-location"),"undefined"!=typeof cookieLoc?(jsonCookie=$.parseJSON(cookieLoc),LaMadLocations.nearestLocationObj.latitude=jsonCookie.latitude,LaMadLocations.nearestLocationObj.longitude=jsonCookie.longitude,LaMadLocations.setLocation(jsonCookie,!0,!0),LaMadLocations.$locationCta.addClass("map-loaded no-cta")):LaMadLocations.$locationCta.find(".flipper").addClass("transition")},getLocation:function(o,e){"linkOut"==o?($directionsLink=$(e),$directionsLink.addClass("loading-directions"),navigator.geolocation.getCurrentPosition(this.geoLinkDir,this.geoErr,{timeout:1e4})):navigator.geolocation?("undefined"!=typeof o?navigator.geolocation.getCurrentPosition(this.geoFoundObjOnly,this.geoErr,{timeout:1e4}):navigator.geolocation.getCurrentPosition(this.geoFound,this.geoErr,{timeout:1e4}),e&&$(e).addClass("geolocate-loading")):$("#map").innerHTML="Geolocation is not supported by this browser."},geoErr:function(o){alert("Pardon, we were unable to determine your location.\nPlease check your network connection and browser settings.\nMerci."),setTimeout(function(){$("body").addClass("location-error"),$("#location-cta").removeClass("map-loading"),$("#location-cta").find(".front-wrapper").show(),$("#header").find(".icon-pin").show(),$("#header").find(".loading").hide(),$("#content").find(".geolocate-loading").removeClass("geolocate-loading")},500)},geoFoundObjOnly:function(o){LaMadLocations.currentLocationObj.latitude=o.coords.latitude,LaMadLocations.currentLocationObj.longitude=o.coords.longitude},geoFound:function(o){LaMadLocations.currentLocationObj.latitude=o.coords.latitude,LaMadLocations.currentLocationObj.longitude=o.coords.longitude,"undefined"!=typeof LaMadLocations.setLargLocation&&LaMadLocations.loadNearest(),LaMadLocations.showPosition(o.coords.latitude,o.coords.longitude),$("#content").find(".geolocate-loading").removeClass("geolocate-loading")},geoLinkDir:function(o){if($directionsLink.removeClass("loading-directions"),$directionsLink="",LaMadLocations.currentLocationObj.latitude=o.coords.latitude,LaMadLocations.currentLocationObj.longitude=o.coords.longitude,-1!=navigator.platform.indexOf("iPhone")||-1!=navigator.platform.indexOf("iPod"))var e="maps";else var e="http";return directionsLink=e+"://maps.google.com/?saddr="+LaMadLocations.currentLocationObj.latitude+","+LaMadLocations.currentLocationObj.longitude+"&daddr="+LaMadLocations.nearestLocationObj.latitude+","+LaMadLocations.nearestLocationObj.longitude+"&directionsmode=driving",LaMadLocations.sendWindow(directionsLink),!0},geoCodeZip:function(o){var e=new google.maps.Geocoder;e.geocode({address:o},function(o,e){"OK"==e&&(LaMadLocations.currentLocationObj=o[0].geometry.location,LaMadLocations.showPosition(o[0].geometry.location.lat(),o[0].geometry.location.lng()),"undefined"!=typeof LaMadLocations.setLargLocation&&LaMadLocations.setLargLocation(o[0].geometry.location.lat(),o[0].geometry.location.lng()))})},showPosition:function(o,e){markers=[],$.ajax({url:"/wp_api/v1/locations/?lat="+o+"&lng="+e,success:function(o){$("body").removeClass("no-locations-found");var e=[];return $.each(o,function(o,a){0==o&&(LaMadLocations.setLocation(a,!0,!1),add_li=!1);var t=new google.maps.LatLng(a.latitude,a.longitude),n=new google.maps.Marker({position:t,map:this.map,title:"Selected Location"});markers.push(n),e[o]=a}),e&&LaMadLocations.setNearbyLocationsStorage(e),LaMadLocations.refreshToGoLink('.widget_lam_orderlinks a[href^="https://online"]'),LaMadLocations.$locationCta.removeClass("map-loading").addClass("map-loaded"),o},error:function(o,e){$("body").addClass("no-locations-found"),LaMadLocations.$locationCta.removeClass("map-loading"),LaMadLocations.$locationCta.find(".no-locations").fadeIn("fast"),setTimeout(function(){LaMadLocations.$locationCta.find(".no-locations").fadeOut("fast"),LaMadLocations.$frontWrapper().fadeIn("fast")},5e3),$("html").hasClass("touch")&&($("#content").hasClass("locations")?alertMsg="Pardon, there are no locations within 100 miles.":alertMsg="Pardon, there are no locations within 100 miles. Please access our Locations page to view all La Madeleine locations.",window.alert(alertMsg)),$("#location-list, #widget-location-mobile").html('<p class="no-locations-list">There are no locations within 100 miles of your search.</p>')}})},sendWindow:function(o){var e=/Safari/.test(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor);e?(link='<a href="'+o+'" target="_new" class="mapit" onClick="">',window.location=o):window.open(o)},getDirections:function(o){if(null==LaMadLocations.currentLocationObj.latitude)this.getLocation("linkOut",o);else{if(-1!=navigator.platform.indexOf("iPhone")||-1!=navigator.platform.indexOf("iPod"))var e="maps";else var e="http";directionsLink=e+"://maps.google.com/maps/?saddr="+LaMadLocations.currentLocationObj.latitude+","+LaMadLocations.currentLocationObj.longitude+"&daddr="+LaMadLocations.nearestLocationObj.latitude+","+LaMadLocations.nearestLocationObj.longitude+"&directionsmode=driving",this.sendWindow(directionsLink)}},launchDirections:function(o){o.preventDefault()},getToGoLink:function(o){var e=LaMadLocations.$toGoLink;if($.cookie("LAM-location")){JSON.parse($.cookie("LAM-location"))}this.sendWindow(e)},refreshToGoLink:function(o){var e=$(o),a=LaMadLocations.$toGoLink;if($.cookie("LAM-location")){JSON.parse($.cookie("LAM-location"));e.attr("href",a)}},refreshLocation:function(o){LaMadLocations.getLocation(void 0,o)},changeSideImage:function(o){img="<img src='"+o+"' >",$("#location-image").html(img)},getImage:function(o,e){"undefined"==typeof e&&(e=!1),$.ajax({url:"/wp_api/v1/locations/image/"+o,success:function(o){return 0==e&&LaMadLocations.changeSideImage(o),o}})}};LaMadLocations.setClickEvent();