var LaMadLocations={sideMap:null,currentLocationObj:{latitude:null,longitude:null},nearestLocationObj:{latitude:null,longitude:null},$locationCta:$("#location-cta"),$frontWrapper:function(){return this.$locationCta.find(".front-wrapper")},initializeMap:function(e,t,n){var r=$("#"+n);if(r.length){newLat=parseFloat(e)+.007;myCenter=new google.maps.LatLng(newLat,t);var i=new google.maps.LatLng(e,t),s={panControl:!1,scrollwheel:!1,draggable:!1,zoomControl:!1,mapTypeControl:!1,scaleControl:!1,streetViewControl:!1,overviewMapControl:!1,center:myCenter,zoom:12},o=new google.maps.Map(document.getElementById(n),s);typeof icon!="undefined"?displayIcon="/wp-content/themes/required-lamadeleine/img/map/blue-dot.png":displayIcon="/wp-content/themes/required-lamadeleine/img/map/custom-pin-drop.png";var u=new google.maps.Marker({position:i,map:o,title:"Nearest Location",icon:displayIcon});this.sideMap=o;$("#directionsLinkButton").show()}},getTodayHours:function(e){var t=new Array(7);t[0]="sunday";t[1]="monday";t[2]="tuesday";t[3]="wednesday";t[4]="thursday";t[5]="friday";t[6]="saturday";var n=new Date;dayIndex=n.getDay();dayOfWeek=t[dayIndex];var r=dayOfWeek+"_open",i=dayOfWeek+"_close",s={open:e[r],close:e[i]};return s},setLocation:function(e,t,n){var r="map",i=LaMadLocations.getTodayHours(e);LaMadLocations.nearestLocationObj=e;$("#location-info").html('<h4 class="location-title">'+e.title+"</h4>"+'<div class="info-wrapper"><div class="address"><strong>Address:</strong><br>'+e.address+" "+e.address_2+"<br>"+e.city+", "+e.state+" "+e.zip_code+'</div><div class="phone"><strong>Phone:</strong><br>'+e.phone+'</div></div><div class="hours"><strong>Today\'s Hours:</strong> '+i.open+" - "+i.close+"</div>");$("#widget-location-mobile").html('<h4 class="location-title">'+e.title+'</h4><hr class="dashed">'+'<div class="info-wrapper"><div class="address"><strong>Address:</strong><br>'+e.address+" "+e.address_2+"<br>"+e.city+", "+e.state+" "+e.zip_code+'</div><div class="hours"><div><strong>Today\'s Hours:</strong></div> '+i.open+" - "+i.close+'</div><div class="btn-wrapper"><a class="btn get-directions" href="#">Directions</a><a class="btn call" href="tel:'+e.phone+'"><span class="icon icon-phone"></span> Call</a>');(typeof n=="undefined"||n==0)&&LaMadLocations.setLocationCookie(e);typeof t!="undefined"&&LaMadLocations.initializeMap(e.latitude,e.longitude,r);$("body").removeClass("no-location");$("body").addClass("has-location")},setLocationCookie:function(e){this.nearestLocationObj=e;$.cookie("LAM-location",JSON.stringify(e),{expires:10,path:"/"})},setNearbyLocationsStorage:function(e){localStorage.setItem("LAM-nearby",JSON.stringify(e))},getLocationCookie:function(){cookieLoc=$.cookie("LAM-location");if(typeof cookieLoc!="undefined"){jsonCookie=$.parseJSON(cookieLoc);LaMadLocations.getLocation(!0);LaMadLocations.nearestLocationObj.latitude=jsonCookie.latitude;LaMadLocations.nearestLocationObj.longitude=jsonCookie.longitude;LaMadLocations.setLocation(jsonCookie,!0,!0);LaMadLocations.$locationCta.addClass("map-loaded no-cta")}else LaMadLocations.$locationCta.find(".flipper").addClass("transition")},getLocation:function(e){navigator.geolocation?typeof e!="undefined"?navigator.geolocation.getCurrentPosition(this.geoFoundObjOnly):navigator.geolocation.getCurrentPosition(this.geoFound):$("#map").innerHTML="Geolocation is not supported by this browser."},geoFoundObjOnly:function(e){LaMadLocations.currentLocationObj.latitude=e.coords.latitude;LaMadLocations.currentLocationObj.longitude=e.coords.longitude},geoFound:function(e){LaMadLocations.currentLocationObj.latitude=e.coords.latitude;LaMadLocations.currentLocationObj.longitude=e.coords.longitude;typeof LaMadLocations.setLargLocation!="undefined"&&LaMadLocations.setLargLocation(e.coords.latitude,e.coords.longitude);LaMadLocations.showPosition(e.coords.latitude,e.coords.longitude)},geoCodeZip:function(e){var t=new google.maps.Geocoder;t.geocode({address:e},function(e,t){if(t=="OK"){LaMadLocations.currentLocationObj=e[0].geometry.location;LaMadLocations.showPosition(e[0].geometry.location.lat(),e[0].geometry.location.lng());typeof LaMadLocations.setLargLocation!="undefined"&&LaMadLocations.setLargLocation(e[0].geometry.location.lat(),e[0].geometry.location.lng())}})},showPosition:function(e,t){markers=[];$.ajax({url:"/wp_api/v1/locations/?lat="+e+"&lng="+t,success:function(e){var t=[];$.each(e,function(e,n){if(e==0){LaMadLocations.setLocation(n,!0,!1);add_li=!1}var r=new google.maps.LatLng(n.latitude,n.longitude),i=new google.maps.Marker({position:r,map:this.map,title:"Selected Location"});markers.push(i);t[e]=n});t&&LaMadLocations.setNearbyLocationsStorage(t);LaMadLocations.$locationCta.removeClass("map-loading").addClass("map-loaded");return e},error:function(e){$("#map").html("No Locations Found")}})},getDirections:function(){directionsLink="http://www.google.com/maps/?saddr="+LaMadLocations.currentLocationObj.latitude+","+LaMadLocations.currentLocationObj.longitude+"&daddr="+LaMadLocations.nearestLocationObj.latitude+","+LaMadLocations.nearestLocationObj.longitude+"&directionsmode=driving";window.open(directionsLink)},changeSideImage:function(e){img="<img src='"+e+"' >";$("#location-image").html(img)},getImage:function(e){$.ajax({url:"/wp_api/v1/locations/image/"+e,success:function(e){LaMadLocations.changeSideImage(e);return e}})}};